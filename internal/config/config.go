package config

import (
	"fmt"

	"github.com/castai/malware-feed/internal/repo"
	"gopkg.in/ini.v1"
)

type Config struct {
}

func Load(path string) ([]repo.Repo, error) {
	data, err := ini.Load(path)

	repos := []repo.Repo{}

	for _, section := range data.Sections() {
		fmt.Println(section.Name())
		for _, entry := range section.Keys() {
			fmt.Println(entry.String())
			// TODO: handle entry without key
			url := entry.String()

			// add entry to repos slice
			repos = append(repos, repo.GithubRepo{
				Url:          url,
				Category:     section.Name(),
				Malware_name: entry.Name(),
			})
		}
	}

	return repos, err
}
